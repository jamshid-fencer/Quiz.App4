const translations = {
  ru: {
    questionProgress: "{current} Ð¸Ð· {total} Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²",
      Filials1: "Ð¢Ð°ÑˆÐºÐµÐ½Ñ‚",
      Filials2: "Ð¡Ð°Ð¼Ð°Ñ€ÐºÐ°Ð½Ð´",
      Filials3: "Ð‘ÑƒÑ…Ð°Ñ€Ð°",
      Filials4: "ÐÐ°Ð¼Ð°Ð½Ð³Ð°Ð½",
      Filials5: "Ð¤ÐµÑ€Ð³Ð°Ð½Ð°",
      Language: "Ð¯Ð·Ñ‹Ðº",
      title: "Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿ÐµÑ€ÐµÐ´ Ñ‚ÐµÑÑ‚Ð¾Ð¼",
      fullname: "Ð¤.Ð˜.Ðž.",
      fullnamePlaceholder: "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¤Ð˜Ðž.",
      branch: "Ð¤Ð¸Ð»Ð¸Ð°Ð» Ð±Ð°Ð½ÐºÐ°:",
      branchPlaceholder: "Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ„Ð¸Ð»Ð¸Ð°Ð»",
      startTest: "ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ‚ÐµÑÑ‚",
      alertFill: "ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð·Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð²ÑÐµ Ð¿Ð¾Ð»Ñ!",
      configTitle: "ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ñ‚ÐµÑÑ‚Ð°",
      chooseCategory: "Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ",
      mortgage: "Ð˜Ð¿Ð¾Ñ‚ÐµÐºÐ°",
      microloan: "ÐœÐ¸ÐºÑ€Ð¾Ð·Ð°Ð¹Ð¼",
      numberOfQuestions: "ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²",
      q5: "5",
      q10: "10",
      q15: "15",
      q20: "20",
      startQuiz: "ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ‚ÐµÑÑ‚",
      quizTitle: "Ð¢ÐµÑÑ‚ Ð¿Ð¾ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°Ð¼",
      sampleQuestion: "Lorem ipsum dolor sit amet.",
      // questionStatus: "{current} {of} {total} {questionsWord}",
      next: "Ð”Ð°Ð»ÑŒÑˆÐµ",
      resultTitle: "Ð¢ÐµÑÑ‚ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½",
      ratingTitle: "ðŸ† Ð ÐµÐ¹Ñ‚Ð¸Ð½Ð³ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²",
      thNumber: "â„–",
      thName: "Ð¤Ð˜Ðž",
      thBranch: "Ð¤Ð¸Ð»Ð¸Ð°Ð»",
      thScore: "Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚",
      thDate: "Ð”Ð°Ñ‚Ð° Ð¿Ñ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ",
      emptyMessage: "ÐŸÐ¾ÐºÐ° Ð½Ð¸ÐºÑ‚Ð¾ Ð½Ðµ Ð¿Ñ€Ð¾ÑˆÑ‘Ð» Ñ‚ÐµÑÑ‚ ðŸ¤·â€â™‚ï¸",
      homeBtn: "ðŸ  Ð”Ð¾Ð¼Ð¾Ð¹",
      clearBtn: "ðŸ—‘ ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³",
      questionsWord: "Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²",
      of: "Ð¸Ð·",
      confirmClear: "Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¾Ñ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³?"
  },
  en: {
      Filials1: "Tashkent",
      Filials2: "Samarkand",
      Filials3: "Bukhara",
      Filials4: "Namangan",
      Filials5: "Fergana",
      Language: "Language",
      title: "Registration before test",
      fullname: "Full Name",
      fullnamePlaceholder: "Enter full name.",
      branch: "Bank branch:",
      branchPlaceholder: "Select branch",
      startTest: "Start test",
      alertFill: "Please fill in all fields!",
      configTitle: "Quiz Configuration",
      chooseCategory: "Choose category",
      mortgage: "Mortgage",
      microloan: "Microloan",
      numberOfQuestions: "Number of questions",
      q5: "5",
      q10: "10",
      q15: "15",
      q20: "20",
      startQuiz: "Start Quiz",
      quizTitle: "Product Quiz",
      sampleQuestion: "Lorem ipsum dolor sit amet.",
      // questionStatus: "{current} {of} {total} {questionsWord}",
      next: "Next",
      resultTitle: "Quiz Completed",
      ratingTitle: "ðŸ† Employee Ranking",
      thNumber: "No.",
      thName: "Full Name",
      thBranch: "Branch",
      thScore: "Score",
      thDate: "Date",
      emptyMessage: "No one has completed the test yet ðŸ¤·â€â™‚ï¸",
      homeBtn: "ðŸ  Home",
      clearBtn: "ðŸ—‘ Clear Ranking",
      questionsWord: "questions",
      of: "of",
      confirmClear: "Are you sure you want to clear the rating?",
      questionProgress: "{current} of {total} questions"
  },
  uz: {
      Filials1: "Toshkent",
      Filials2: "Samarqand",
      Filials3: "Buxoro",
      Filials4: "Namangan",
      Filials5: "Fargâ€˜ona",
      Language: "Til",
      title: "Testdan oldin roâ€˜yxatdan oâ€˜tish",
      fullname: "Familiya, Ism, Sharif",
      fullnamePlaceholder: "Familiya va ismingizni kiriting.",
      branch: "Bank filiali:",
      branchPlaceholder: "Filialni tanlang",
      startTest: "Testni boshlash",
      alertFill: "Iltimos, barcha maydonlarni toâ€˜ldiring!",
      configTitle: "Test konfiguratsiyasi",
      chooseCategory: "Kategoriya tanlang",
      mortgage: "Ipoteka",
      microloan: "Mikrozaym",
      numberOfQuestions: "Savollar soni",
      q5: "5",
      q10: "10",
      q15: "15",
      q20: "20",
      startQuiz: "Testni boshlash",
      quizTitle: "Mahsulotlar boâ€˜yicha test",
      sampleQuestion: "Lorem ipsum dolor sit amet.",
      // questionStatus: "{current} {of} {total} {questionsWord}",
      next: "Keyingi",
      resultTitle: "Test yakunlandi",
      ratingTitle: "ðŸ† Xodimlar reytingi",
      thNumber: "â„–",
      thName: "Familiya, Ism",
      thBranch: "Filial",
      thScore: "Natija",
      thDate: "Oâ€˜tgan sana",
      emptyMessage: "Hali hech kim testni tugatmagan ðŸ¤·â€â™‚ï¸",
      homeBtn: "ðŸ  Bosh sahifa",
      clearBtn: "ðŸ—‘ Reytingni tozalash",
      questionsWord: "savol",
      of: "dan",
      confirmClear: "Reytingni tozalashni xohlaysizmi?",
      questionProgress: "{current} / {total} savol"
  }
};


  
  


// Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´ Ðº ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñƒ (textContent)
function translateElement(el, key, lang) {
  const text = translations[lang] && translations[lang][key];
  if (text !== undefined) el.textContent = text;
}

// ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ: Ð¾Ð±Ñ…Ð¾Ð´Ð¸Ñ‚ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹ Ð¸ Ð·Ð°Ð¼ÐµÐ½ÑÐµÑ‚ Ñ‚ÐµÐºÑÑ‚Ñ‹/Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚Ñ‹
function applyTranslations(lang) {
  if (!translations[lang]) return;

  // 1) ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ Ñ data-i18n -> Ð·Ð°Ð¼ÐµÐ½ÑÐµÑ‚ textContent
  document.querySelectorAll("[data-i18n]").forEach(el => {
    const map = el.getAttribute("data-i18n").trim();
    // Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð²Ð¸Ð´Ð° "key:attr" (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€ "fullnamePlaceholder:placeholder")
    if (map.includes(":")) {
      const [key, attr] = map.split(":").map(s => s.trim());
      const value = translations[lang][key];
      if (value !== undefined) el.setAttribute(attr, value);
    } else {
      const value = translations[lang][map];
      if (value !== undefined) el.textContent = value;
    }
  });

  document.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
    const key = el.getAttribute("data-i18n-placeholder");
    const value = translations[lang][key];
    if (value !== undefined) {
      el.placeholder = value;
    }
  });

  // 2) ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ Ñ data-i18n-html -> Ð·Ð°Ð¼ÐµÐ½ÑÐµÑ‚ innerHTML (ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶ÐµÐ½ emoji/markup)
  document.querySelectorAll("[data-i18n-html]").forEach(el => {
    const key = el.getAttribute("data-i18n-html").trim();
    const value = translations[lang][key];
    if (value !== undefined) el.innerHTML = value;
  });

  // 3) ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ placeholder -> data-i18n-placeholder="key"
  document.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
    const key = el.getAttribute("data-i18n-placeholder").trim();
    const value = translations[lang][key];
    if (value !== undefined) el.placeholder = value;
  });

  // 4) value attribute (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€ ÐºÐ½Ð¾Ð¿ÐºÐ¸ input type=button) -> data-i18n-value="key"
  document.querySelectorAll("[data-i18n-value]").forEach(el => {
    const key = el.getAttribute("data-i18n-value").trim();
    const value = translations[lang][key];
    if (value !== undefined) el.value = value;
  });

  // 5) title attribute -> data-i18n-title="key"
  document.querySelectorAll("[data-i18n-title]").forEach(el => {
    const key = el.getAttribute("data-i18n-title").trim();
    const value = translations[lang][key];
    if (value !== undefined) el.title = value;
  });
}

// Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ ÑÐ·Ñ‹ÐºÐ° (Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ‹Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¸Ð· ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸)
function setLanguage(lang) {
  if (!translations[lang]) lang = "ru";
  localStorage.setItem("lang", lang);
  applyTranslations(lang);
  // ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ Ð´Ð»Ñ Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ñ… ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð² (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€ renderQuestion Ð¼Ð¾Ð¶ÐµÑ‚ ÑÐ»ÑƒÑˆÐ°Ñ‚ÑŒ)
  window.dispatchEvent(new CustomEvent("languageChanged", { detail: { lang } }));
}

// Ð°Ð²Ñ‚Ð¾Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ
document.addEventListener("DOMContentLoaded", () => {
  const lang = localStorage.getItem("lang") || "ru";
  // ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ ÑÐµÐ»ÐµÐºÑ‚ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ - ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼
  const sel = document.getElementById("langSelect");
  if (sel) {
    sel.value = lang;
    sel.addEventListener("change", (e) => setLanguage(e.target.value));
  }
  setLanguage(lang);
});


